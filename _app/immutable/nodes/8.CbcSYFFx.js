import{t as v,e as y,a as g}from"../chunks/CLAry2k1.js";import{i as Re}from"../chunks/DdeQhgMz.js";import{p as Ve,o as je,t as k,g as r,b as Ie,$ as Pe,d as l,c as m,s as o,e as i,j as ge,r as a,n as ve,h as be,m as De}from"../chunks/CHWvRFv0.js";import{h as Le,s as U}from"../chunks/I2gD431L.js";import{i as Y}from"../chunks/BO9lghZz.js";import{e as Z,i as _e,r as M,b as ye}from"../chunks/rhR0QdnA.js";import{b as R}from"../chunks/BgFIFfUn.js";import{b as xe}from"../chunks/KueDq6cs.js";import{p as he}from"../chunks/Bfc47y5P.js";import{s as A}from"../chunks/DgHr3P3x.js";var Se=v('<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert"><strong class="font-bold">Error:</strong> <span class="block sm:inline"> </span></div>'),qe=v("<option> </option>"),Ke=v("<option> </option>"),ze=v("<p>Loading targets...</p>"),Be=v("<p>No targets defined yet.</p>"),Ge=v('<tr><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><input type="number" step="any" placeholder="None" class="p-1 w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"><input type="number" step="any" placeholder="None" class="p-1 w-24 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><button class="text-red-600 hover:text-red-900">Delete</button></td></tr>'),He=v('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Target</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Min Value</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Max Value</th><th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),Je=v('<div class="container mx-auto p-4 max-w-4xl"><h1 class="text-2xl font-bold mb-6">Manage Nutrition Targets</h1> <!> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"><div class="border p-4 rounded shadow"><h2 class="text-lg font-semibold mb-3">Add Absolute Target</h2> <form><div class="mb-3"><label for="absoluteNutrient" class="block text-sm font-medium text-gray-700 mb-1">Nutrient</label> <select id="absoluteNutrient" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></select></div> <div class="grid grid-cols-2 gap-4 mb-3"><div><label for="absoluteMin" class="block text-sm font-medium text-gray-700 mb-1">Min Value</label> <input type="number" id="absoluteMin" step="any" placeholder="Optional" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></div> <div><label for="absoluteMax" class="block text-sm font-medium text-gray-700 mb-1">Max Value</label> <input type="number" id="absoluteMax" step="any" placeholder="Optional" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></div></div> <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">Add Absolute Target</button></form></div> <div class="border p-4 rounded shadow"><h2 class="text-lg font-semibold mb-3">Add Relative Target</h2> <form><div class="mb-3"><label for="relativeTargetType" class="block text-sm font-medium text-gray-700 mb-1">Target Type</label> <select id="relativeTargetType" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></select></div> <div class="grid grid-cols-2 gap-4 mb-3"><div><label for="relativeMin" class="block text-sm font-medium text-gray-700 mb-1">Min %</label> <input type="number" id="relativeMin" step="any" placeholder="Optional" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></div> <div><label for="relativeMax" class="block text-sm font-medium text-gray-700 mb-1">Max %</label> <input type="number" id="relativeMax" step="any" placeholder="Optional" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"></div></div> <button type="submit" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">Add Relative Target</button></form></div></div> <div><h2 class="text-xl font-semibold mb-4">Current Targets</h2> <!></div></div>');function it(we,Te){Ve(Te,!1);let f=m([]),V=m(!0),c=m(null),b=m("calories"),N=m(null),F=m(null),x=m("protein_percent_calories"),E=m(null),O=m(null);const ke=["calories","protein","fat","carbs","fibers","sugar","mufa","pufa","sfa","omega3","omega6","gl"],h={protein_percent_calories:{label:"Protein (% of Calories)",n1:"protein",n2:"calories"},fat_percent_calories:{label:"Fat (% of Calories)",n1:"fat",n2:"calories"},carbs_percent_calories:{label:"Carbs (% of Calories)",n1:"carbs",n2:"calories"},omega6_omega3_ratio:{label:"Omega-6 / Omega-3 Ratio (%)",n1:"omega6",n2:"omega3"},pufa_sfa_ratio:{label:"PUFA / SFA Ratio (%)",n1:"pufa",n2:"sfa"},mufa_percent_fat:{label:"MUFA (% of Total Fat)",n1:"mufa",n2:"fat"},pufa_percent_fat:{label:"PUFA (% of Total Fat)",n1:"pufa",n2:"fat"},sfa_percent_fat:{label:"SFA (% of Total Fat)",n1:"sfa",n2:"fat"}};je(async()=>{await w()});async function w(){o(V,!0),o(c,null);try{const{data:e,error:t}=await A.from("nutrition_targets").select("*").order("nutrient_1",{ascending:!0}).order("nutrient_2",{ascending:!0,nullsFirst:!0});if(t)throw t;o(f,e||[])}catch(e){o(c,`Failed to load targets: ${e.message}`),console.error(e)}finally{o(V,!1)}}async function Me(){if(r(b)){o(c,null);try{const{error:e}=await A.from("nutrition_targets").insert({nutrient_1:r(b),nutrient_2:null,min_value:r(N),max_value:r(F)});if(e)throw e.code==="23505"?new Error(`A target for "${te(r(b),null)}" already exists.`):e;o(b,"calories"),o(N,null),o(F,null),await w()}catch(e){o(c,`Failed to add absolute target: ${e.message}`),console.error(e)}}}async function Ae(){if(!r(x))return;o(c,null);const e=h[r(x)];if(!e){o(c,"Invalid relative target type selected.");return}try{const{error:t}=await A.from("nutrition_targets").insert({nutrient_1:e.n1,nutrient_2:e.n2,min_value:r(E),max_value:r(O)});if(t)throw t.code==="23505"?new Error(`A target for "${e.label}" already exists.`):t;o(x,"protein_percent_calories"),o(E,null),o(O,null),await w()}catch(t){o(c,`Failed to add relative target: ${t.message}`),console.error(t)}}async function Ne(e){if(confirm("Are you sure you want to delete this target?")){o(c,null);try{const{error:t}=await A.from("nutrition_targets").delete().match({id:e});if(t)throw t;await w()}catch(t){o(c,`Failed to delete target: ${t.message}`),console.error(t)}}}async function ee(e,t,s){const d=s===null||isNaN(Number(s))?null:Number(s);if(e[t]!==d){o(c,null);try{const{error:n}=await A.from("nutrition_targets").update({[t]:d}).match({id:e.id});if(n)throw n;const u=r(f).findIndex(T=>T.id===e.id);u!==-1?(De(f,r(f)[u]={...r(f)[u],[t]:d}),o(f,[...r(f)])):await w()}catch(n){o(c,`Failed to update target: ${n.message}`),console.error(n),await w()}}}function te(e,t){if(t===null){const s=e==="calories"?"kcal":"g";return`${e.charAt(0).toUpperCase()+e.slice(1)} (${s})`}else{const s=Object.keys(h).find(d=>h[d].n1===e&&h[d].n2===t);return s?h[s].label:`${e} / ${t} (%)`}}Re();var j=Je();Le(e=>{Pe.title="Nutrition Targets - Eatelligence"});var re=l(i(j),2);{var Fe=e=>{var t=Se(),s=l(i(t),2),d=i(s,!0);a(s),a(t),k(()=>U(d,r(c))),g(e,t)};Y(re,e=>{r(c)&&e(Fe)})}var I=l(re,2),P=i(I),D=l(i(P),2),L=i(D),S=l(i(L),2);k(()=>{r(b),ge(()=>{})}),Z(S,5,()=>ke,_e,(e,t)=>{var s=qe(),d={},n=i(s,!0);a(s),k(u=>{d!==(d=r(t))&&(s.value=(s.__value=r(t))??""),U(n,u)},[()=>r(t).charAt(0).toUpperCase()+r(t).slice(1)],be),g(e,s)}),a(S),a(L);var ae=l(L,2),q=i(ae),oe=l(i(q),2);M(oe),a(q);var ie=l(q,2),se=l(i(ie),2);M(se),a(ie),a(ae),ve(2),a(D),a(P);var le=l(P,2),K=l(i(le),2),z=i(K),B=l(i(z),2);k(()=>{r(x),ge(()=>{})}),Z(B,5,()=>Object.entries(h),_e,(e,t)=>{let s=()=>r(t)[0],d=()=>r(t)[1];var n=Ke(),u={},T=i(n,!0);a(n),k(()=>{u!==(u=s())&&(n.value=(n.__value=s())??""),U(T,d().label)}),g(e,n)}),a(B),a(z);var ne=l(z,2),G=i(ne),de=l(i(G),2);M(de),a(G);var ue=l(G,2),ce=l(i(ue),2);M(ce),a(ue),a(ne),ve(2),a(K),a(le),a(I);var pe=l(I,2),Ee=l(i(pe),2);{var Oe=e=>{var t=ze();g(e,t)},$e=(e,t)=>{{var s=n=>{var u=Be();g(n,u)},d=n=>{var u=He(),T=i(u),fe=l(i(T));Z(fe,5,()=>r(f),H=>H.id,(H,_)=>{var J=Ge(),Q=i(J),Ce=i(Q,!0);a(Q);var W=l(Q),$=i(W);M($),a(W);var X=l(W),C=i(X);M(C),a(X);var me=l(X),Ue=i(me);a(me),a(J),k(p=>{U(Ce,p),ye($,r(_).min_value),ye(C,r(_).max_value)},[()=>te(r(_).nutrient_1,r(_).nutrient_2)],be),y("blur",$,p=>ee(r(_),"min_value",p.currentTarget.valueAsNumber)),y("keydown",$,p=>{p.key==="Enter"&&p.currentTarget.blur()}),y("blur",C,p=>ee(r(_),"max_value",p.currentTarget.valueAsNumber)),y("keydown",C,p=>{p.key==="Enter"&&p.currentTarget.blur()}),y("click",Ue,()=>Ne(r(_).id)),g(H,J)}),a(fe),a(T),a(u),g(n,u)};Y(e,n=>{r(f).length===0?n(s):n(d,!1)},t)}};Y(Ee,e=>{r(V)?e(Oe):e($e,!1)})}a(pe),a(j),xe(S,()=>r(b),e=>o(b,e)),R(oe,()=>r(N),e=>o(N,e)),R(se,()=>r(F),e=>o(F,e)),y("submit",D,he(Me)),xe(B,()=>r(x),e=>o(x,e)),R(de,()=>r(E),e=>o(E,e)),R(ce,()=>r(O),e=>o(O,e)),y("submit",K,he(Ae)),g(we,j),Ie()}export{it as component};
